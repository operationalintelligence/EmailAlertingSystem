{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: kafka-python in /eos/home-y/ysunthor/.local/lib/python3.6/site-packages (1.4.6)\n",
      "\u001b[31mpy2neo 4.0.0 requires colorama, which is not installed.\u001b[0m\n",
      "\u001b[31mpy2neo 4.0.0 requires neo4j-driver>=1.6.0, which is not installed.\u001b[0m\n",
      "\u001b[31mparamiko 2.4.0 requires bcrypt>=3.1.3, which is not installed.\u001b[0m\n",
      "\u001b[31mparamiko 2.4.0 requires cryptography>=1.5, which is not installed.\u001b[0m\n",
      "\u001b[31mparamiko 2.4.0 requires pyasn1>=0.1.7, which is not installed.\u001b[0m\n",
      "\u001b[31mparamiko 2.4.0 requires pynacl>=1.0.1, which is not installed.\u001b[0m\n",
      "\u001b[31mpy2neo 4.0.0 has requirement prompt_toolkit==1.0.15, but you'll have prompt-toolkit 2.0.9 which is incompatible.\u001b[0m\n",
      "\u001b[31mkeras 2.2.0 has requirement keras_applications==1.0.2, but you'll have keras-applications 1.0.6 which is incompatible.\u001b[0m\n",
      "\u001b[31mkeras 2.2.0 has requirement keras_preprocessing==1.0.1, but you'll have keras-preprocessing 1.0.5 which is incompatible.\u001b[0m\n",
      "\u001b[33mYou are using pip version 10.0.1, however version 19.1.1 is available.\n",
      "You should consider upgrading via the 'pip install --upgrade pip' command.\u001b[0m\n"
     ]
    }
   ],
   "source": [
    "!pip install --user kafka-python"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The Jupyter HTML Notebook.\n",
      "\n",
      "This launches a Tornado based HTML Notebook Server that serves up an\n",
      "HTML5/Javascript Notebook client.\n",
      "\n",
      "Subcommands\n",
      "-----------\n",
      "\n",
      "Subcommands are launched as `jupyter-notebook cmd [args]`. For information on\n",
      "using subcommand 'cmd', do: `jupyter-notebook cmd -h`.\n",
      "\n",
      "list\n",
      "    List currently running notebook servers.\n",
      "stop\n",
      "    Stop currently running notebook server for a given port\n",
      "password\n",
      "    Set a password for the notebook server.\n",
      "\n",
      "Options\n",
      "-------\n",
      "\n",
      "Arguments that take values are actually convenience aliases to full\n",
      "Configurables, whose aliases are listed on the help line. For more information\n",
      "on full configurables, see '--help-all'.\n",
      "\n",
      "--debug\n",
      "    set log level to logging.DEBUG (maximize logging output)\n",
      "--generate-config\n",
      "    generate default config file\n",
      "-y\n",
      "    Answer yes to any questions instead of prompting.\n",
      "--no-browser\n",
      "    Don't open the notebook in a browser after startup.\n",
      "--pylab\n",
      "    DISABLED: use %pylab or %matplotlib in the notebook to enable matplotlib.\n",
      "--no-mathjax\n",
      "    Disable MathJax\n",
      "    \n",
      "    MathJax is the javascript library Jupyter uses to render math/LaTeX. It is\n",
      "    very large, so you may want to disable it if you have a slow internet\n",
      "    connection, or for offline use of the notebook.\n",
      "    \n",
      "    When disabled, equations etc. will appear as their untransformed TeX source.\n",
      "--allow-root\n",
      "    Allow the notebook to be run from root user.\n",
      "--script\n",
      "    DEPRECATED, IGNORED\n",
      "--no-script\n",
      "    DEPRECATED, IGNORED\n",
      "--log-level=<Enum> (Application.log_level)\n",
      "    Default: 30\n",
      "    Choices: (0, 10, 20, 30, 40, 50, 'DEBUG', 'INFO', 'WARN', 'ERROR', 'CRITICAL')\n",
      "    Set the log level by value or name.\n",
      "--config=<Unicode> (JupyterApp.config_file)\n",
      "    Default: ''\n",
      "    Full path of a config file.\n",
      "--ip=<Unicode> (NotebookApp.ip)\n",
      "    Default: 'localhost'\n",
      "    The IP address the notebook server will listen on.\n",
      "--port=<Int> (NotebookApp.port)\n",
      "    Default: 8888\n",
      "    The port the notebook server will listen on.\n",
      "--port-retries=<Int> (NotebookApp.port_retries)\n",
      "    Default: 50\n",
      "    The number of additional ports to try if the specified port is not\n",
      "    available.\n",
      "--transport=<CaselessStrEnum> (KernelManager.transport)\n",
      "    Default: 'tcp'\n",
      "    Choices: ['tcp', 'ipc']\n",
      "--keyfile=<Unicode> (NotebookApp.keyfile)\n",
      "    Default: ''\n",
      "    The full path to a private key file for usage with SSL/TLS.\n",
      "--certfile=<Unicode> (NotebookApp.certfile)\n",
      "    Default: ''\n",
      "    The full path to an SSL/TLS certificate file.\n",
      "--client-ca=<Unicode> (NotebookApp.client_ca)\n",
      "    Default: ''\n",
      "    The full path to a certificate authority certificate for SSL/TLS client\n",
      "    authentication.\n",
      "--notebook-dir=<Unicode> (NotebookApp.notebook_dir)\n",
      "    Default: ''\n",
      "    The directory to use for notebooks and kernels.\n",
      "--browser=<Unicode> (NotebookApp.browser)\n",
      "    Default: ''\n",
      "    Specify what command to use to invoke a web browser when opening the\n",
      "    notebook. If not specified, the default browser will be determined by the\n",
      "    `webbrowser` standard library module, which allows setting of the BROWSER\n",
      "    environment variable to override it.\n",
      "--pylab=<Unicode> (NotebookApp.pylab)\n",
      "    Default: 'disabled'\n",
      "    DISABLED: use %pylab or %matplotlib in the notebook to enable matplotlib.\n",
      "\n",
      "To see all available configurables, use `--help-all`\n",
      "\n",
      "Examples\n",
      "--------\n",
      "\n",
      "    jupyter notebook                       # start the notebook\n",
      "    jupyter notebook --certfile=mycert.pem # use SSL/TLS certificate\n",
      "    jupyter notebook password              # enter a password to protect the server\n",
      "\n",
      "[C 10:31:24.592 NotebookApp] Bad config encountered during initialization:\n",
      "[C 10:31:24.592 NotebookApp] The 'contents_manager_class' trait of <notebook.notebookapp.NotebookApp object at 0x7f85fa104828> instance must be a type, but 'swancontents.filemanager.swanfilemanager.SwanFileManager' could not be imported\n"
     ]
    }
   ],
   "source": [
    "!jupyter notebook --NotebookApp.iopub_data_rate_limit=1.0e10"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Welcome to parse engine\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-05_04-30-06.log\n",
      "WARNING: too many xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "OK: xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-06_04-30-05.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-07_04-30-04.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "WARNING: too many xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "OK: xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-08_04-30-05.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-09_04-30-04.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-10_04-30-04.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-11_04-30-04.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-12_04-30-04.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "The collector xrootd_2 in vocms042.cern.ch was not running\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "The collector xrootd_2 in vocms043.cern.ch was not running\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-13_04-30-01.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 70%>=70%\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\n",
      " inodes\n",
      "WARNING: too many xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "CRITICAL: too many xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-14_04-30-01.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "CRITICAL: too many xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 70%>=70%\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 71%>=70%\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\n",
      " inodes\n",
      "PopDB cronJob of cron_2019-04-15_04-30-05.log\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 71%>=70%\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\n",
      " inodes\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 70%>=70%\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 70%>=70%\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 70%>=70%\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\n",
      " inodes\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 70%>=70%\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\n",
      " inodes\n",
      "WARNING: too many xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "OK: xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\n",
      " inodes\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Notification: Stop two insertion agents at vocms043.cern.ch\n",
      "Notification: Stop two insertion agents at vocms042.cern.ch\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-16_04-30-05.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-17_04-30-03.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-18_04-30-02.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-19_04-30-04.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-20_04-30-08.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-21_04-30-05.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-22_04-30-03.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-23_04-30-03.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-24_04-30-02.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-25_04-30-04.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 70%>=70%\n",
      " inodes\n",
      "WARNING: too many xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "CRITICAL: too many xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 70%>=70%\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\n",
      " inodes\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 70%>=70%\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 70%>=70%\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\n",
      " inodes\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 70%>=70%\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 70%>=70%\n",
      " inodes\n",
      "WARNING: too many xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\n",
      " inodes\n",
      "OK: xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\n",
      " inodes\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "PopDB cronJob of cron_2019-04-26_04-30-03.log\n",
      "Notification: Stop two insertion agents at vocms043.cern.ch\n",
      "Notification: Stop two insertion agents at vocms042.cern.ch\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-27_04-30-04.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-28_04-30-02.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-29_04-30-01.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-30_04-30-06.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-05-01_04-30-02.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-05-02_04-30-01.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-05-03_04-30-02.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-05-04_04-30-01.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-05-05_04-30-04.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-05-06_04-30-04.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-05-07_04-30-04.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-05-08_04-30-03.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-05-09_04-30-02.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-05-10_04-30-06.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-05-11_04-30-02.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-05-12_04-30-04.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-05-13_04-30-01.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "WARNING: too many xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "OK: xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "The collector xrootd_1 in vocms043.cern.ch was not running\n",
      "The collector xrootd_2 in vocms043.cern.ch was not running\n",
      "The collector xrootd_2 in vocms042.cern.ch was not running\n",
      "The collector xrootd_1 in vocms042.cern.ch was not running\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "The collector xrootd_2 in vocms043.cern.ch was not running\n",
      "The collector xrootd_1 in vocms042.cern.ch was not running\n",
      "The collector xrootd_2 in vocms042.cern.ch was not running\n",
      "The collector xrootd_1 in vocms043.cern.ch was not running\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "The collector xrootd_1 in vocms043.cern.ch was not running\n",
      "The collector xrootd_2 in vocms043.cern.ch was not running\n",
      "The collector xrootd_1 in vocms042.cern.ch was not running\n",
      "The collector xrootd_2 in vocms042.cern.ch was not running\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron alert CMS Popularity\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron alert CMS Popularity\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron alert CMS Popularity\n",
      "Cron alert CMS Popularity\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron alert CMS Popularity\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Cron alert CMS Popularity\n",
      "Cron alert CMS Popularity\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron alert CMS Popularity\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron alert CMS Popularity\n",
      "Cron alert CMS Popularity\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron alert CMS Popularity\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n"
     ]
    },
    {
     "ename": "KeyboardInterrupt",
     "evalue": "",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)",
      "\u001b[0;32m<ipython-input-4-7338aed3c6b2>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[1;32m     15\u001b[0m                              \u001b[0mvalue_deserializer\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mlambda\u001b[0m \u001b[0mm\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0mjson\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mloads\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mm\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     16\u001b[0m                             )\n\u001b[0;32m---> 17\u001b[0;31m     \u001b[0;32mfor\u001b[0m \u001b[0mmessage\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mconsumer\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     18\u001b[0m         \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmessage\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mvalue\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'subject'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     19\u001b[0m \u001b[0;32mexcept\u001b[0m \u001b[0mException\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/.local/lib/python3.6/site-packages/kafka/consumer/group.py\u001b[0m in \u001b[0;36m__next__\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m   1118\u001b[0m         \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_set_consumer_timeout\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1119\u001b[0m         \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1120\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mnext\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_iterator\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1121\u001b[0m         \u001b[0;32mexcept\u001b[0m \u001b[0mStopIteration\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1122\u001b[0m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_iterator\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/.local/lib/python3.6/site-packages/kafka/consumer/group.py\u001b[0m in \u001b[0;36m_message_generator\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m   1073\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_fetcher\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0min_flight_fetches\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1074\u001b[0m                 \u001b[0mpoll_ms\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmin\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mpoll_ms\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mconfig\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'reconnect_backoff_ms'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1075\u001b[0;31m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_client\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpoll\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtimeout_ms\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mpoll_ms\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1076\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1077\u001b[0m             \u001b[0;31m# after the long poll, we should check whether the group needs to rebalance\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/.local/lib/python3.6/site-packages/kafka/client_async.py\u001b[0m in \u001b[0;36mpoll\u001b[0;34m(self, timeout_ms, future)\u001b[0m\n\u001b[1;32m    591\u001b[0m                     \u001b[0mtimeout\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmax\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtimeout\u001b[0m \u001b[0;34m/\u001b[0m \u001b[0;36m1000\u001b[0m\u001b[0;34m)\u001b[0m  \u001b[0;31m# avoid negative timeouts\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    592\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 593\u001b[0;31m                 \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_poll\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtimeout\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    594\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    595\u001b[0m                 \u001b[0mresponses\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mextend\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_fire_pending_completed_requests\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/.local/lib/python3.6/site-packages/kafka/client_async.py\u001b[0m in \u001b[0;36m_poll\u001b[0;34m(self, timeout)\u001b[0m\n\u001b[1;32m    612\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    613\u001b[0m         \u001b[0mstart_select\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mtime\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtime\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 614\u001b[0;31m         \u001b[0mready\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_selector\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mselect\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtimeout\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    615\u001b[0m         \u001b[0mend_select\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mtime\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtime\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    616\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_sensors\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m/cvmfs/sft.cern.ch/lcg/releases/Python/3.6.5-54b64/x86_64-centos7-gcc7-opt/lib/python3.6/selectors.py\u001b[0m in \u001b[0;36mselect\u001b[0;34m(self, timeout)\u001b[0m\n\u001b[1;32m    443\u001b[0m             \u001b[0mready\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    444\u001b[0m             \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 445\u001b[0;31m                 \u001b[0mfd_event_list\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_epoll\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpoll\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtimeout\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmax_ev\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    446\u001b[0m             \u001b[0;32mexcept\u001b[0m \u001b[0mInterruptedError\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    447\u001b[0m                 \u001b[0;32mreturn\u001b[0m \u001b[0mready\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mKeyboardInterrupt\u001b[0m: "
     ]
    }
   ],
   "source": [
    "from kafka import KafkaConsumer\n",
    "import json\n",
    "from pyspark.sql import SparkSession\n",
    "from pyspark.sql.functions import explode\n",
    "from pyspark.sql.functions import split\n",
    "from pymongo import MongoClient\n",
    "try:\n",
    "    print('Welcome to parse engine')\n",
    "    consumer = KafkaConsumer('email_alert',\n",
    "                             bootstrap_servers='188.185.79.229:9092',\n",
    "#To subscribe since the first message that has been produced to kafka producer\n",
    "                             auto_offset_reset='earliest',\n",
    "                             enable_auto_commit=False,\n",
    "                             group_id=None,\n",
    "                             value_deserializer=lambda m: json.loads(m)\n",
    "                            )\n",
    "    for message in consumer:\n",
    "        print(message.value['subject'])\n",
    "except Exception as e:\n",
    "    print(e)\n",
    "    # Logs the error appropriately.\n",
    "    pass"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "--2019-06-05 14:22:30--  http://central.maven.org/maven2/org/apache/spark/spark-sql-kafka-0-10_2.12/2.4.3/spark-sql-kafka-0-10_2.12-2.4.3.jar\n",
      "Resolving central.maven.org (central.maven.org)... 151.101.112.209\n",
      "Connecting to central.maven.org (central.maven.org)|151.101.112.209|:80... connected.\n",
      "HTTP request sent, awaiting response... 200 OK\n",
      "Length: 297636 (291K) [application/java-archive]\n",
      "Saving to: ‘spark-sql-kafka-0-10_2.12-2.4.3.jar’\n",
      "\n",
      "100%[======================================>] 297,636     --.-K/s   in 0.04s   \n",
      "\n",
      "2019-06-05 14:22:31 (7.83 MB/s) - ‘spark-sql-kafka-0-10_2.12-2.4.3.jar’ saved [297636/297636]\n",
      "\n"
     ]
    }
   ],
   "source": [
    "!wget http://central.maven.org/maven2/org/apache/spark/spark-sql-kafka-0-10_2.12/2.4.3/spark-sql-kafka-0-10_2.12-2.4.3.jar"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "--2019-06-05 16:08:07--  http://central.maven.org/maven2/org/apache/spark/spark-streaming-kafka-0-8-assembly_2.10/2.0.0-preview/spark-streaming-kafka-0-8-assembly_2.10-2.0.0-preview.jar\n",
      "Resolving central.maven.org (central.maven.org)... 151.101.112.209\n",
      "Connecting to central.maven.org (central.maven.org)|151.101.112.209|:80... connected.\n",
      "HTTP request sent, awaiting response... 200 OK\n",
      "Length: 10268332 (9.8M) [application/java-archive]\n",
      "Saving to: ‘spark-streaming-kafka-0-8-assembly_2.10-2.0.0-preview.jar’\n",
      "\n",
      "100%[======================================>] 10,268,332  30.2MB/s   in 0.3s   \n",
      "\n",
      "2019-06-05 16:08:08 (30.2 MB/s) - ‘spark-streaming-kafka-0-8-assembly_2.10-2.0.0-preview.jar’ saved [10268332/10268332]\n",
      "\n"
     ]
    }
   ],
   "source": [
    "!wget http://central.maven.org/maven2/org/apache/spark/spark-streaming-kafka-0-8-assembly_2.10/2.0.0-preview/spark-streaming-kafka-0-8-assembly_2.10-2.0.0-preview.jar"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'spark' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "\u001b[0;32m<ipython-input-1-6405004f221d>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[0;31m# Subscribe to 1 topic\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 2\u001b[0;31m \u001b[0mdf\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mspark\u001b[0m\u001b[0;31m \u001b[0m\u001b[0;31m\\\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      3\u001b[0m   \u001b[0;34m.\u001b[0m\u001b[0mreadStream\u001b[0m\u001b[0;31m \u001b[0m\u001b[0;31m\\\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      4\u001b[0m   \u001b[0;34m.\u001b[0m\u001b[0mformat\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"kafka\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;31m \u001b[0m\u001b[0;31m\\\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      5\u001b[0m   \u001b[0;34m.\u001b[0m\u001b[0moption\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"kafka.bootstrap.servers\"\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m\"188.185.79.229:9092\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;31m \u001b[0m\u001b[0;31m\\\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mNameError\u001b[0m: name 'spark' is not defined"
     ]
    }
   ],
   "source": [
    "# Subscribe to 1 topic\n",
    "df = spark \\\n",
    "  .readStream \\\n",
    "  .format(\"kafka\") \\\n",
    "  .option(\"kafka.bootstrap.servers\", \"188.185.79.229:9092\") \\\n",
    "  .option(\"subscribe\", \"email_alert\") \\\n",
    "  .load()\n",
    "df.selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "sql = spark.sql\n",
    "sql(\"select 'Hello World!'\").show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "from pyspark.sql import SQLContext\n",
    "sqlContext = HiveContext(sc)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/usr/bin/sh: confluent: command not found\r\n"
     ]
    }
   ],
   "source": [
    "\n",
    "! confluent start ksql-server"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.5"
  },
  "sparkconnect": {
   "bundled_options": [],
   "list_of_options": [
    {
     "name": "spark.jars",
     "value": "/eos/home-y/ysunthor/SWAN_projects/test/"
    },
    {
     "name": "spark.jars.packages",
     "value": "org.apache.spark:spark-sql-kafka-0-10_2.12:2.4.3"
    }
   ]
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
