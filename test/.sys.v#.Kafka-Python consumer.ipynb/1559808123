{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "!pip install --user kafka-python"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "!jupyter notebook --NotebookApp.iopub_data_rate_limit=1.0e10"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "from kafka import KafkaConsumer\n",
    "import json\n",
    "try:\n",
    "    print('Welcome to parse engine')\n",
    "    consumer = KafkaConsumer('email_alert',\n",
    "                             bootstrap_servers='188.185.79.229:9092',\n",
    "#To subscribe since the first message that has been produced to kafka producer\n",
    "                             auto_offset_reset='earliest',\n",
    "                             enable_auto_commit=False,\n",
    "                             group_id=None,\n",
    "                             value_deserializer=lambda m: json.loads(m)\n",
    "                            )\n",
    "    for message in consumer:\n",
    "        print(message.value['subject'])\n",
    "except Exception as e:\n",
    "    print(e)\n",
    "    # Logs the error appropriately.\n",
    "    pass"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "!wget http://central.maven.org/maven2/org/apache/spark/spark-sql-kafka-0-10_2.11/2.4.1/spark-sql-kafka-0-10_2.11-2.4.1.jar"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "!wget http://central.maven.org/maven2/org/apache/spark/spark-streaming-kafka-0-8-assembly_2.10/2.0.0-preview/spark-streaming-kafka-0-8-assembly_2.10-2.0.0-preview.jar"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "root\n",
      " |-- key: binary (nullable = true)\n",
      " |-- value: binary (nullable = true)\n",
      " |-- topic: string (nullable = true)\n",
      " |-- partition: integer (nullable = true)\n",
      " |-- offset: long (nullable = true)\n",
      " |-- timestamp: timestamp (nullable = true)\n",
      " |-- timestampType: integer (nullable = true)\n",
      "\n",
      "root\n",
      " |-- value: string (nullable = true)\n",
      " |-- timestamp: timestamp (nullable = true)\n",
      "\n"
     ]
    }
   ],
   "source": [
    "from pyspark.sql.types import StructType\n",
    "import json\n",
    "# Subscribe to 1 topic\n",
    "dfraw = spark.readStream.format(\"kafka\")\\\n",
    ".option(\"kafka.bootstrap.servers\", \"188.185.79.229:9092\")\\\n",
    ".option(\"subscribe\",\"email_alert\")\\\n",
    ".option(\"startingOffsets\", \"earliest\") \\\n",
    ".option(\"value.deserializer\",lambda m: json.loads(m))\\\n",
    ".load()\n",
    "\n",
    "#   .option(\"startingOffsets\", \"earliest\") \\\n",
    "dfraw.printSchema()\n",
    "df = dfraw.selectExpr(\"CAST(value AS STRING)\",\"CAST(timestamp AS timestamp)\")\n",
    "\n",
    "df.printSchema()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# emailCounts = streaming.groupBy(\"subject\").count()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "metadata": {},
   "outputs": [],
   "source": [
    "flow=df.writeStream.queryName(\"email\")\\\n",
    "  .outputMode(\"append\")\\\n",
    "  .format(\"memory\")\\\n",
    "  .start()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 35,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "spark.streams.active"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [],
   "source": [
    "flow.stop()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+--------------------+-------------------+\n",
      "|               value|          timestamp|\n",
      "+--------------------+-------------------+\n",
      "|{\"subject\": \"Prob...|2019-06-04 00:00:04|\n",
      "|{\"subject\": \"Prob...|2019-06-04 10:30:02|\n",
      "|{\"subject\": \"Prob...|2019-04-05 02:20:04|\n",
      "|{\"subject\": \"Cron...|2019-04-05 03:00:03|\n",
      "|{\"subject\": \"Prob...|2019-04-05 04:40:02|\n",
      "|{\"subject\": \"Prob...|2019-04-05 08:20:01|\n",
      "|{\"subject\": \"PopD...|2019-04-05 11:08:19|\n",
      "|{\"subject\": \"WARN...|2019-04-05 12:51:14|\n",
      "|{\"subject\": \"OK: ...|2019-04-05 13:04:14|\n",
      "|{\"subject\": \"Prob...|2019-04-05 18:10:04|\n",
      "|{\"subject\": \"Prob...|2019-04-05 20:40:01|\n",
      "|{\"subject\": \"Prob...|2019-04-05 23:40:02|\n",
      "|{\"subject\": \"Cron...|2019-04-06 03:00:07|\n",
      "|{\"subject\": \"Prob...|2019-04-06 04:40:02|\n",
      "|{\"subject\": \"PopD...|2019-04-06 10:46:32|\n",
      "|{\"subject\": \"Prob...|2019-04-06 15:00:01|\n",
      "|{\"subject\": \"Prob...|2019-04-07 00:00:03|\n",
      "|{\"subject\": \"Cron...|2019-04-07 03:00:09|\n",
      "|{\"subject\": \"Prob...|2019-04-07 04:40:02|\n",
      "|{\"subject\": \"PopD...|2019-04-07 10:12:23|\n",
      "+--------------------+-------------------+\n",
      "only showing top 20 rows\n",
      "\n"
     ]
    }
   ],
   "source": [
    "# spark.sql(\"select * from email\").show()\n",
    "alerts = spark.sql(\"select * from email\")\n",
    "alerts.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "metadata": {},
   "outputs": [],
   "source": [
    "from ast import literal_eval\n",
    "rddAlertsRdd = alerts.rdd.map(lambda alert: literal_eval(alert['value']))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "PythonRDD[25] at RDD at PythonRDD.scala:53"
      ]
     },
     "execution_count": 40,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "rddAlertsRdd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "metadata": {},
   "outputs": [],
   "source": [
    "rddAlerts = rddAlertsRdd.collect()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 96,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-05_04-30-06.log\n",
      "WARNING: too many xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "OK: xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-06_04-30-05.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-07_04-30-04.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "WARNING: too many xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "OK: xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-08_04-30-05.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-09_04-30-04.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-10_04-30-04.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-11_04-30-04.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-12_04-30-04.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "The collector xrootd_2 in vocms042.cern.ch was not running\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "The collector xrootd_2 in vocms043.cern.ch was not running\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-13_04-30-01.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "WARNING: too many xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "CRITICAL: too many xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-14_04-30-01.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "CRITICAL: too many xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 71%>=70%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "PopDB cronJob of cron_2019-04-15_04-30-05.log\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 71%>=70%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "WARNING: too many xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "OK: xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Notification: Stop two insertion agents at vocms043.cern.ch\n",
      "Notification: Stop two insertion agents at vocms042.cern.ch\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-16_04-30-05.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-17_04-30-03.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-18_04-30-02.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-19_04-30-04.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-20_04-30-08.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-21_04-30-05.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-22_04-30-03.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-23_04-30-03.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-24_04-30-02.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-25_04-30-04.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "WARNING: too many xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "CRITICAL: too many xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "WARNING: too many xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "OK: xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "PopDB cronJob of cron_2019-04-26_04-30-03.log\n",
      "Notification: Stop two insertion agents at vocms043.cern.ch\n",
      "Notification: Stop two insertion agents at vocms042.cern.ch\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-27_04-30-04.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-28_04-30-02.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-29_04-30-01.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-30_04-30-06.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-05-01_04-30-02.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-05-02_04-30-01.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-05-03_04-30-02.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-05-04_04-30-01.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-05-05_04-30-04.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-05-06_04-30-04.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-05-07_04-30-04.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-05-08_04-30-03.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-05-09_04-30-02.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-05-10_04-30-06.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-05-11_04-30-02.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-05-12_04-30-04.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-05-13_04-30-01.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "WARNING: too many xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "OK: xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "The collector xrootd_1 in vocms043.cern.ch was not running\n",
      "The collector xrootd_2 in vocms043.cern.ch was not running\n",
      "The collector xrootd_2 in vocms042.cern.ch was not running\n",
      "The collector xrootd_1 in vocms042.cern.ch was not running\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "The collector xrootd_2 in vocms043.cern.ch was not running\n",
      "The collector xrootd_1 in vocms042.cern.ch was not running\n",
      "The collector xrootd_2 in vocms042.cern.ch was not running\n",
      "The collector xrootd_1 in vocms043.cern.ch was not running\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "The collector xrootd_1 in vocms043.cern.ch was not running\n",
      "The collector xrootd_2 in vocms043.cern.ch was not running\n",
      "The collector xrootd_1 in vocms042.cern.ch was not running\n",
      "The collector xrootd_2 in vocms042.cern.ch was not running\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron alert CMS Popularity\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron alert CMS Popularity\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron alert CMS Popularity\n",
      "Cron alert CMS Popularity\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron alert CMS Popularity\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Cron alert CMS Popularity\n",
      "Cron alert CMS Popularity\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron alert CMS Popularity\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron alert CMS Popularity\n",
      "Cron alert CMS Popularity\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron alert CMS Popularity\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n"
     ]
    }
   ],
   "source": [
    "# rddAlerts[0]\n",
    "for i in rddAlerts:\n",
    "    print(i[\"subject\"])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "metadata": {},
   "outputs": [],
   "source": [
    "pdAlerts = alerts.toPandas()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>value</th>\n",
       "      <th>timestamp</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-06-04 00:00:04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-06-04 10:30:02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-04-05 02:20:04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>{\"subject\": \"Cron &lt;root@vocms041&gt; cd /opt/CMSD...</td>\n",
       "      <td>2019-04-05 03:00:03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-04-05 04:40:02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-04-05 08:20:01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>{\"subject\": \"PopDB cronJob of cron_2019-04-05_...</td>\n",
       "      <td>2019-04-05 11:08:19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>{\"subject\": \"WARNING: too many xrootd-cms-eos-...</td>\n",
       "      <td>2019-04-05 12:51:14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>{\"subject\": \"OK: xrootd-cms-eos-popularity mes...</td>\n",
       "      <td>2019-04-05 13:04:14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-04-05 18:10:04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-04-05 20:40:01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-04-05 23:40:02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>{\"subject\": \"Cron &lt;root@vocms041&gt; cd /opt/CMSD...</td>\n",
       "      <td>2019-04-06 03:00:07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-04-06 04:40:02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>{\"subject\": \"PopDB cronJob of cron_2019-04-06_...</td>\n",
       "      <td>2019-04-06 10:46:32</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-04-06 15:00:01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-04-07 00:00:03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>{\"subject\": \"Cron &lt;root@vocms041&gt; cd /opt/CMSD...</td>\n",
       "      <td>2019-04-07 03:00:09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-04-07 04:40:02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>{\"subject\": \"PopDB cronJob of cron_2019-04-07_...</td>\n",
       "      <td>2019-04-07 10:12:23</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-04-07 16:10:02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>{\"subject\": \"WARNING: too many xrootd-cms-eos-...</td>\n",
       "      <td>2019-04-07 17:19:14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>{\"subject\": \"OK: xrootd-cms-eos-popularity mes...</td>\n",
       "      <td>2019-04-07 17:27:14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-04-08 00:00:02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>{\"subject\": \"Cron &lt;root@vocms041&gt; cd /opt/CMSD...</td>\n",
       "      <td>2019-04-08 03:00:05</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-04-08 04:40:04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-04-08 06:50:03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>{\"subject\": \"PopDB cronJob of cron_2019-04-08_...</td>\n",
       "      <td>2019-04-08 10:08:59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-04-08 15:20:03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-04-08 20:20:01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>535</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-05-30 09:30:02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>536</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-05-30 22:40:02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>537</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-05-31 03:00:02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>538</th>\n",
       "      <td>{\"subject\": \"Cron &lt;root@vocms041&gt; cd /opt/CMSD...</td>\n",
       "      <td>2019-05-31 03:00:04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>539</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-05-31 06:00:02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>540</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-05-31 10:20:02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>541</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-05-31 13:50:01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>542</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-05-31 18:30:02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>543</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-05-31 22:40:02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>544</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-06-01 01:30:01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>545</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-06-01 05:20:01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>546</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-06-01 08:30:01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>547</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-06-01 12:30:03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>548</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-06-01 15:50:02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>549</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-06-01 20:00:01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>550</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-06-01 23:10:03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>551</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-06-02 02:30:03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>552</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-06-02 06:40:01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>553</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-06-02 09:50:01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>554</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-06-02 12:50:03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>555</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-06-02 16:10:01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>556</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-06-02 19:50:01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>557</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-06-02 22:40:02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>558</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-06-03 01:20:03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>559</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-06-03 04:50:02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>560</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-06-03 10:40:02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>561</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-06-03 14:00:02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>562</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-06-03 18:20:01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>563</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-06-04 00:00:04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>564</th>\n",
       "      <td>{\"subject\": \"Problem POPDB Xrootd File2DS CRON...</td>\n",
       "      <td>2019-06-04 10:30:02</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>565 rows  2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                 value           timestamp\n",
       "0    {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-06-04 00:00:04\n",
       "1    {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-06-04 10:30:02\n",
       "2    {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-04-05 02:20:04\n",
       "3    {\"subject\": \"Cron <root@vocms041> cd /opt/CMSD... 2019-04-05 03:00:03\n",
       "4    {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-04-05 04:40:02\n",
       "5    {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-04-05 08:20:01\n",
       "6    {\"subject\": \"PopDB cronJob of cron_2019-04-05_... 2019-04-05 11:08:19\n",
       "7    {\"subject\": \"WARNING: too many xrootd-cms-eos-... 2019-04-05 12:51:14\n",
       "8    {\"subject\": \"OK: xrootd-cms-eos-popularity mes... 2019-04-05 13:04:14\n",
       "9    {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-04-05 18:10:04\n",
       "10   {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-04-05 20:40:01\n",
       "11   {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-04-05 23:40:02\n",
       "12   {\"subject\": \"Cron <root@vocms041> cd /opt/CMSD... 2019-04-06 03:00:07\n",
       "13   {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-04-06 04:40:02\n",
       "14   {\"subject\": \"PopDB cronJob of cron_2019-04-06_... 2019-04-06 10:46:32\n",
       "15   {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-04-06 15:00:01\n",
       "16   {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-04-07 00:00:03\n",
       "17   {\"subject\": \"Cron <root@vocms041> cd /opt/CMSD... 2019-04-07 03:00:09\n",
       "18   {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-04-07 04:40:02\n",
       "19   {\"subject\": \"PopDB cronJob of cron_2019-04-07_... 2019-04-07 10:12:23\n",
       "20   {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-04-07 16:10:02\n",
       "21   {\"subject\": \"WARNING: too many xrootd-cms-eos-... 2019-04-07 17:19:14\n",
       "22   {\"subject\": \"OK: xrootd-cms-eos-popularity mes... 2019-04-07 17:27:14\n",
       "23   {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-04-08 00:00:02\n",
       "24   {\"subject\": \"Cron <root@vocms041> cd /opt/CMSD... 2019-04-08 03:00:05\n",
       "25   {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-04-08 04:40:04\n",
       "26   {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-04-08 06:50:03\n",
       "27   {\"subject\": \"PopDB cronJob of cron_2019-04-08_... 2019-04-08 10:08:59\n",
       "28   {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-04-08 15:20:03\n",
       "29   {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-04-08 20:20:01\n",
       "..                                                 ...                 ...\n",
       "535  {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-05-30 09:30:02\n",
       "536  {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-05-30 22:40:02\n",
       "537  {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-05-31 03:00:02\n",
       "538  {\"subject\": \"Cron <root@vocms041> cd /opt/CMSD... 2019-05-31 03:00:04\n",
       "539  {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-05-31 06:00:02\n",
       "540  {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-05-31 10:20:02\n",
       "541  {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-05-31 13:50:01\n",
       "542  {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-05-31 18:30:02\n",
       "543  {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-05-31 22:40:02\n",
       "544  {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-06-01 01:30:01\n",
       "545  {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-06-01 05:20:01\n",
       "546  {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-06-01 08:30:01\n",
       "547  {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-06-01 12:30:03\n",
       "548  {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-06-01 15:50:02\n",
       "549  {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-06-01 20:00:01\n",
       "550  {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-06-01 23:10:03\n",
       "551  {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-06-02 02:30:03\n",
       "552  {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-06-02 06:40:01\n",
       "553  {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-06-02 09:50:01\n",
       "554  {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-06-02 12:50:03\n",
       "555  {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-06-02 16:10:01\n",
       "556  {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-06-02 19:50:01\n",
       "557  {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-06-02 22:40:02\n",
       "558  {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-06-03 01:20:03\n",
       "559  {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-06-03 04:50:02\n",
       "560  {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-06-03 10:40:02\n",
       "561  {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-06-03 14:00:02\n",
       "562  {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-06-03 18:20:01\n",
       "563  {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-06-04 00:00:04\n",
       "564  {\"subject\": \"Problem POPDB Xrootd File2DS CRON... 2019-06-04 10:30:02\n",
       "\n",
       "[565 rows x 2 columns]"
      ]
     },
     "execution_count": 46,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pdAlerts"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0     2019-06-04 00:00:04\n",
       "1     2019-06-04 10:30:02\n",
       "2     2019-04-05 02:20:04\n",
       "3     2019-04-05 03:00:03\n",
       "4     2019-04-05 04:40:02\n",
       "5     2019-04-05 08:20:01\n",
       "6     2019-04-05 11:08:19\n",
       "7     2019-04-05 12:51:14\n",
       "8     2019-04-05 13:04:14\n",
       "9     2019-04-05 18:10:04\n",
       "10    2019-04-05 20:40:01\n",
       "11    2019-04-05 23:40:02\n",
       "12    2019-04-06 03:00:07\n",
       "13    2019-04-06 04:40:02\n",
       "14    2019-04-06 10:46:32\n",
       "15    2019-04-06 15:00:01\n",
       "16    2019-04-07 00:00:03\n",
       "17    2019-04-07 03:00:09\n",
       "18    2019-04-07 04:40:02\n",
       "19    2019-04-07 10:12:23\n",
       "20    2019-04-07 16:10:02\n",
       "21    2019-04-07 17:19:14\n",
       "22    2019-04-07 17:27:14\n",
       "23    2019-04-08 00:00:02\n",
       "24    2019-04-08 03:00:05\n",
       "25    2019-04-08 04:40:04\n",
       "26    2019-04-08 06:50:03\n",
       "27    2019-04-08 10:08:59\n",
       "28    2019-04-08 15:20:03\n",
       "29    2019-04-08 20:20:01\n",
       "              ...        \n",
       "535   2019-05-30 09:30:02\n",
       "536   2019-05-30 22:40:02\n",
       "537   2019-05-31 03:00:02\n",
       "538   2019-05-31 03:00:04\n",
       "539   2019-05-31 06:00:02\n",
       "540   2019-05-31 10:20:02\n",
       "541   2019-05-31 13:50:01\n",
       "542   2019-05-31 18:30:02\n",
       "543   2019-05-31 22:40:02\n",
       "544   2019-06-01 01:30:01\n",
       "545   2019-06-01 05:20:01\n",
       "546   2019-06-01 08:30:01\n",
       "547   2019-06-01 12:30:03\n",
       "548   2019-06-01 15:50:02\n",
       "549   2019-06-01 20:00:01\n",
       "550   2019-06-01 23:10:03\n",
       "551   2019-06-02 02:30:03\n",
       "552   2019-06-02 06:40:01\n",
       "553   2019-06-02 09:50:01\n",
       "554   2019-06-02 12:50:03\n",
       "555   2019-06-02 16:10:01\n",
       "556   2019-06-02 19:50:01\n",
       "557   2019-06-02 22:40:02\n",
       "558   2019-06-03 01:20:03\n",
       "559   2019-06-03 04:50:02\n",
       "560   2019-06-03 10:40:02\n",
       "561   2019-06-03 14:00:02\n",
       "562   2019-06-03 18:20:01\n",
       "563   2019-06-04 00:00:04\n",
       "564   2019-06-04 10:30:02\n",
       "Name: timestamp, Length: 565, dtype: datetime64[ns]"
      ]
     },
     "execution_count": 50,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pdAlertsSeries = pdAlerts['value'].map(literal_eval)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 76,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>body</th>\n",
       "      <th>subject</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>timestamp</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2019-04-05</th>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-06</th>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-07</th>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-08</th>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-09</th>\n",
       "      <td>12</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-10</th>\n",
       "      <td>12</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-11</th>\n",
       "      <td>12</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-12</th>\n",
       "      <td>13</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-13</th>\n",
       "      <td>13</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-14</th>\n",
       "      <td>15</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-15</th>\n",
       "      <td>45</td>\n",
       "      <td>45</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-16</th>\n",
       "      <td>12</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-17</th>\n",
       "      <td>12</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-18</th>\n",
       "      <td>11</td>\n",
       "      <td>11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-19</th>\n",
       "      <td>13</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-20</th>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-21</th>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-22</th>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-23</th>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-24</th>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-25</th>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-26</th>\n",
       "      <td>34</td>\n",
       "      <td>34</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-27</th>\n",
       "      <td>11</td>\n",
       "      <td>11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-28</th>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-29</th>\n",
       "      <td>12</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-30</th>\n",
       "      <td>11</td>\n",
       "      <td>11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-01</th>\n",
       "      <td>12</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-02</th>\n",
       "      <td>11</td>\n",
       "      <td>11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-03</th>\n",
       "      <td>12</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-04</th>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-06</th>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-07</th>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-08</th>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-09</th>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-10</th>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-11</th>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-12</th>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-13</th>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-14</th>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-15</th>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-16</th>\n",
       "      <td>6</td>\n",
       "      <td>6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-17</th>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-18</th>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-19</th>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-20</th>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-21</th>\n",
       "      <td>25</td>\n",
       "      <td>25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-22</th>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-23</th>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-24</th>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-25</th>\n",
       "      <td>11</td>\n",
       "      <td>11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-26</th>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-27</th>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-28</th>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-29</th>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-30</th>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-31</th>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-06-01</th>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-06-02</th>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-06-03</th>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-06-04</th>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>61 rows  2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "            body  subject\n",
       "timestamp                \n",
       "2019-04-05    10       10\n",
       "2019-04-06     4        4\n",
       "2019-04-07     7        7\n",
       "2019-04-08     8        8\n",
       "2019-04-09    12       12\n",
       "2019-04-10    12       12\n",
       "2019-04-11    12       12\n",
       "2019-04-12    13       13\n",
       "2019-04-13    13       13\n",
       "2019-04-14    15       15\n",
       "2019-04-15    45       45\n",
       "2019-04-16    12       12\n",
       "2019-04-17    12       12\n",
       "2019-04-18    11       11\n",
       "2019-04-19    13       13\n",
       "2019-04-20     8        8\n",
       "2019-04-21     9        9\n",
       "2019-04-22     5        5\n",
       "2019-04-23     5        5\n",
       "2019-04-24     7        7\n",
       "2019-04-25     9        9\n",
       "2019-04-26    34       34\n",
       "2019-04-27    11       11\n",
       "2019-04-28    10       10\n",
       "2019-04-29    12       12\n",
       "2019-04-30    11       11\n",
       "2019-05-01    12       12\n",
       "2019-05-02    11       11\n",
       "2019-05-03    12       12\n",
       "2019-05-04    10       10\n",
       "...          ...      ...\n",
       "2019-05-06     9        9\n",
       "2019-05-07     8        8\n",
       "2019-05-08    10       10\n",
       "2019-05-09     9        9\n",
       "2019-05-10     8        8\n",
       "2019-05-11     9        9\n",
       "2019-05-12     9        9\n",
       "2019-05-13     8        8\n",
       "2019-05-14     3        3\n",
       "2019-05-15     3        3\n",
       "2019-05-16     6        6\n",
       "2019-05-17     5        5\n",
       "2019-05-18     5        5\n",
       "2019-05-19     2        2\n",
       "2019-05-20     5        5\n",
       "2019-05-21    25       25\n",
       "2019-05-22     3        3\n",
       "2019-05-23     2        2\n",
       "2019-05-24     7        7\n",
       "2019-05-25    11       11\n",
       "2019-05-26     4        4\n",
       "2019-05-27     2        2\n",
       "2019-05-28     2        2\n",
       "2019-05-29     2        2\n",
       "2019-05-30     5        5\n",
       "2019-05-31     7        7\n",
       "2019-06-01     7        7\n",
       "2019-06-02     7        7\n",
       "2019-06-03     5        5\n",
       "2019-06-04     4        4\n",
       "\n",
       "[61 rows x 2 columns]"
      ]
     },
     "execution_count": 76,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas\n",
    "pdAlertsDf = pandas.DataFrame(list(pdAlertsSeries))\n",
    "pdAlertsDf.index = pdAlerts['timestamp']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 62,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>body</th>\n",
       "      <th>subject</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>timestamp</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2019-06-04 00:00:04</th>\n",
       "      <td>check log in /opt/CMSDataPopularity/xrootd/log...</td>\n",
       "      <td>Problem POPDB Xrootd File2DS CRON</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-06-04 10:30:02</th>\n",
       "      <td>check log in /opt/CMSDataPopularity/xrootd/log...</td>\n",
       "      <td>Problem POPDB Xrootd File2DS CRON</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-05 02:20:04</th>\n",
       "      <td>check log in /opt/CMSDataPopularity/xrootd/log...</td>\n",
       "      <td>Problem POPDB Xrootd File2DS CRON</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-05 03:00:03</th>\n",
       "      <td>WARNING: MView MV_XRD_STAT1 not refreshed sinc...</td>\n",
       "      <td>Cron &lt;root@vocms041&gt; cd /opt/CMSDataPopularity...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-05 04:40:02</th>\n",
       "      <td>check log in /opt/CMSDataPopularity/xrootd/log...</td>\n",
       "      <td>Problem POPDB Xrootd File2DS CRON</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                                  body  \\\n",
       "timestamp                                                                \n",
       "2019-06-04 00:00:04  check log in /opt/CMSDataPopularity/xrootd/log...   \n",
       "2019-06-04 10:30:02  check log in /opt/CMSDataPopularity/xrootd/log...   \n",
       "2019-04-05 02:20:04  check log in /opt/CMSDataPopularity/xrootd/log...   \n",
       "2019-04-05 03:00:03  WARNING: MView MV_XRD_STAT1 not refreshed sinc...   \n",
       "2019-04-05 04:40:02  check log in /opt/CMSDataPopularity/xrootd/log...   \n",
       "\n",
       "                                                               subject  \n",
       "timestamp                                                               \n",
       "2019-06-04 00:00:04                  Problem POPDB Xrootd File2DS CRON  \n",
       "2019-06-04 10:30:02                  Problem POPDB Xrootd File2DS CRON  \n",
       "2019-04-05 02:20:04                  Problem POPDB Xrootd File2DS CRON  \n",
       "2019-04-05 03:00:03  Cron <root@vocms041> cd /opt/CMSDataPopularity...  \n",
       "2019-04-05 04:40:02                  Problem POPDB Xrootd File2DS CRON  "
      ]
     },
     "execution_count": 62,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pdAlertsDf.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 83,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>body</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>subject</th>\n",
       "      <th>timestamp</th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th rowspan=\"3\" valign=\"top\">CRITICAL: too many xrootd-cms-eos-popularity messages stored on the dashb brokers</th>\n",
       "      <th>2019-04-14</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-15</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-25</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"27\" valign=\"top\">Cron &lt;root@vocms041&gt; cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py</th>\n",
       "      <th>2019-04-05</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-06</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-07</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-08</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-09</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-10</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-11</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-12</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-13</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-14</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-15</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-16</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-17</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-18</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-19</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-21</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-23</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-24</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-01</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-03</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-04</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-06</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-11</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-12</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-16</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-17</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-18</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"17\" valign=\"top\">Problem POPDB Xrootd File2DS CRON</th>\n",
       "      <th>2019-05-19</th>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-20</th>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-21</th>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-22</th>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-23</th>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-24</th>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-25</th>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-26</th>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-27</th>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-28</th>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-29</th>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-30</th>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-31</th>\n",
       "      <td>6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-06-01</th>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-06-02</th>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-06-03</th>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-06-04</th>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>The collector xrootd_1 in vocms042.cern.ch was not running</th>\n",
       "      <th>2019-05-21</th>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>The collector xrootd_1 in vocms043.cern.ch was not running</th>\n",
       "      <th>2019-05-21</th>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">The collector xrootd_2 in vocms042.cern.ch was not running</th>\n",
       "      <th>2019-04-13</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-21</th>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">The collector xrootd_2 in vocms043.cern.ch was not running</th>\n",
       "      <th>2019-04-13</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-21</th>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"7\" valign=\"top\">WARNING: too many xrootd-cms-eos-popularity messages stored on the dashb brokers</th>\n",
       "      <th>2019-04-05</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-07</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-14</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-15</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-25</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-04-26</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-05-16</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>173 rows  1 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                               body\n",
       "subject                                            timestamp       \n",
       "CRITICAL: too many xrootd-cms-eos-popularity me... 2019-04-14     1\n",
       "                                                   2019-04-15     1\n",
       "                                                   2019-04-25     1\n",
       "Cron <root@vocms041> cd /opt/CMSDataPopularity/... 2019-04-05     1\n",
       "                                                   2019-04-06     1\n",
       "                                                   2019-04-07     1\n",
       "                                                   2019-04-08     1\n",
       "                                                   2019-04-09     1\n",
       "                                                   2019-04-10     1\n",
       "                                                   2019-04-11     1\n",
       "                                                   2019-04-12     1\n",
       "                                                   2019-04-13     1\n",
       "                                                   2019-04-14     1\n",
       "                                                   2019-04-15     1\n",
       "                                                   2019-04-16     1\n",
       "                                                   2019-04-17     1\n",
       "                                                   2019-04-18     1\n",
       "                                                   2019-04-19     1\n",
       "                                                   2019-04-21     1\n",
       "                                                   2019-04-23     1\n",
       "                                                   2019-04-24     1\n",
       "                                                   2019-05-01     1\n",
       "                                                   2019-05-03     1\n",
       "                                                   2019-05-04     1\n",
       "                                                   2019-05-06     1\n",
       "                                                   2019-05-11     1\n",
       "                                                   2019-05-12     1\n",
       "                                                   2019-05-16     1\n",
       "                                                   2019-05-17     1\n",
       "                                                   2019-05-18     1\n",
       "...                                                             ...\n",
       "Problem POPDB Xrootd File2DS CRON                  2019-05-19     2\n",
       "                                                   2019-05-20     4\n",
       "                                                   2019-05-21    12\n",
       "                                                   2019-05-22     3\n",
       "                                                   2019-05-23     2\n",
       "                                                   2019-05-24     3\n",
       "                                                   2019-05-25     4\n",
       "                                                   2019-05-26     3\n",
       "                                                   2019-05-27     2\n",
       "                                                   2019-05-28     2\n",
       "                                                   2019-05-29     2\n",
       "                                                   2019-05-30     4\n",
       "                                                   2019-05-31     6\n",
       "                                                   2019-06-01     7\n",
       "                                                   2019-06-02     7\n",
       "                                                   2019-06-03     5\n",
       "                                                   2019-06-04     4\n",
       "The collector xrootd_1 in vocms042.cern.ch was ... 2019-05-21     3\n",
       "The collector xrootd_1 in vocms043.cern.ch was ... 2019-05-21     3\n",
       "The collector xrootd_2 in vocms042.cern.ch was ... 2019-04-13     1\n",
       "                                                   2019-05-21     3\n",
       "The collector xrootd_2 in vocms043.cern.ch was ... 2019-04-13     1\n",
       "                                                   2019-05-21     3\n",
       "WARNING: too many xrootd-cms-eos-popularity mes... 2019-04-05     1\n",
       "                                                   2019-04-07     1\n",
       "                                                   2019-04-14     1\n",
       "                                                   2019-04-15     1\n",
       "                                                   2019-04-25     1\n",
       "                                                   2019-04-26     1\n",
       "                                                   2019-05-16     1\n",
       "\n",
       "[173 rows x 1 columns]"
      ]
     },
     "execution_count": 83,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import datetime\n",
    "aggSubject=pdAlertsDf.groupby(['subject',pandas.Grouper(freq='24H')]).count()\n",
    "aggSubject"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.5"
  },
  "sparkconnect": {
   "bundled_options": [],
   "list_of_options": [
    {
     "name": "spark.jars",
     "value": "/eos/home-y/ysunthor/SWAN_projects/test"
    },
    {
     "name": "spark.jars.packages",
     "value": "org.apache.spark:spark-sql-kafka-0-10_2.11:2.4.1"
    }
   ]
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
