{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "!pip install --user kafka-python"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "!jupyter notebook --NotebookApp.iopub_data_rate_limit=1.0e10"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "from kafka import KafkaConsumer\n",
    "import json\n",
    "try:\n",
    "    print('Welcome to parse engine')\n",
    "    consumer = KafkaConsumer('email_alert',\n",
    "                             bootstrap_servers='188.185.79.229:9092',\n",
    "#To subscribe since the first message that has been produced to kafka producer\n",
    "                             auto_offset_reset='earliest',\n",
    "                             enable_auto_commit=False,\n",
    "                             group_id=None,\n",
    "                             value_deserializer=lambda m: json.loads(m)\n",
    "                            )\n",
    "    for message in consumer:\n",
    "        print(message.value['subject'])\n",
    "except Exception as e:\n",
    "    print(e)\n",
    "    # Logs the error appropriately.\n",
    "    pass"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "!wget http://central.maven.org/maven2/org/apache/spark/spark-sql-kafka-0-10_2.11/2.4.1/spark-sql-kafka-0-10_2.11-2.4.1.jar"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 73,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "root\n",
      " |-- key: binary (nullable = true)\n",
      " |-- value: binary (nullable = true)\n",
      " |-- topic: string (nullable = true)\n",
      " |-- partition: integer (nullable = true)\n",
      " |-- offset: long (nullable = true)\n",
      " |-- timestamp: timestamp (nullable = true)\n",
      " |-- timestampType: integer (nullable = true)\n",
      "\n",
      "root\n",
      " |-- value: string (nullable = true)\n",
      "\n"
     ]
    }
   ],
   "source": [
    "from pyspark.sql.types import StructType\n",
    "import json\n",
    "# Subscribe to 1 topic\n",
    "dfraw = spark.readStream.format(\"kafka\")\\\n",
    ".option(\"kafka.bootstrap.servers\", \"188.185.79.229:9092\")\\\n",
    ".option(\"subscribe\",\"email_alert\")\\\n",
    ".option(\"startingOffsets\", \"earliest\") \\\n",
    ".option(\"value.deserializer\",lambda m: json.loads(m))\\\n",
    ".load()\n",
    "\n",
    "#   .option(\"startingOffsets\", \"earliest\") \\\n",
    "dfraw.printSchema()\n",
    "df = dfraw.selectExpr(\"CAST(value AS STRING)\")\n",
    "\n",
    "df.printSchema()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# emailCounts = streaming.groupBy(\"subject\").count()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 77,
   "metadata": {},
   "outputs": [],
   "source": [
    "flow=df.writeStream.queryName(\"email\")\\\n",
    "  .outputMode(\"append\")\\\n",
    "  .format(\"memory\")\\\n",
    "  .start()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "spark.streams.active"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 78,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<pyspark.sql.streaming.StreamingQuery at 0x7fa5a83265f8>]"
      ]
     },
     "execution_count": 78,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "flow.stop()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 79,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+--------------------+\n",
      "|               value|\n",
      "+--------------------+\n",
      "|{\"subject\": \"Prob...|\n",
      "|{\"subject\": \"Prob...|\n",
      "|{\"subject\": \"Prob...|\n",
      "|{\"subject\": \"Cron...|\n",
      "|{\"subject\": \"Prob...|\n",
      "|{\"subject\": \"Prob...|\n",
      "|{\"subject\": \"PopD...|\n",
      "|{\"subject\": \"WARN...|\n",
      "|{\"subject\": \"OK: ...|\n",
      "|{\"subject\": \"Prob...|\n",
      "|{\"subject\": \"Prob...|\n",
      "|{\"subject\": \"Prob...|\n",
      "|{\"subject\": \"Cron...|\n",
      "|{\"subject\": \"Prob...|\n",
      "|{\"subject\": \"PopD...|\n",
      "|{\"subject\": \"Prob...|\n",
      "|{\"subject\": \"Prob...|\n",
      "|{\"subject\": \"Cron...|\n",
      "|{\"subject\": \"Prob...|\n",
      "|{\"subject\": \"PopD...|\n",
      "+--------------------+\n",
      "only showing top 20 rows\n",
      "\n"
     ]
    }
   ],
   "source": [
    "# spark.sql(\"select * from email\").show()\n",
    "alerts = spark.sql(\"select * from email\")\n",
    "alerts.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 84,
   "metadata": {},
   "outputs": [],
   "source": [
    "from ast import literal_eval\n",
    "rddAlertsRdd = alerts.rdd.map(lambda alert: literal_eval(alert['value']))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 85,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "PythonRDD[84] at RDD at PythonRDD.scala:53"
      ]
     },
     "execution_count": 85,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "rddAlertsRdd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 86,
   "metadata": {},
   "outputs": [],
   "source": [
    "rddAlerts = rddAlertsRdd.collect()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 96,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-05_04-30-06.log\n",
      "WARNING: too many xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "OK: xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-06_04-30-05.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-07_04-30-04.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "WARNING: too many xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "OK: xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-08_04-30-05.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-09_04-30-04.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-10_04-30-04.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-11_04-30-04.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-12_04-30-04.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "The collector xrootd_2 in vocms042.cern.ch was not running\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "The collector xrootd_2 in vocms043.cern.ch was not running\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-13_04-30-01.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "WARNING: too many xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "CRITICAL: too many xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-14_04-30-01.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "CRITICAL: too many xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 71%>=70%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "PopDB cronJob of cron_2019-04-15_04-30-05.log\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 71%>=70%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "WARNING: too many xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "OK: xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Notification: Stop two insertion agents at vocms043.cern.ch\n",
      "Notification: Stop two insertion agents at vocms042.cern.ch\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-16_04-30-05.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-17_04-30-03.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-18_04-30-02.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-19_04-30-04.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-20_04-30-08.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-21_04-30-05.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-22_04-30-03.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-23_04-30-03.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-24_04-30-02.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-25_04-30-04.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "WARNING: too many xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "CRITICAL: too many xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Stop simplevisor at vocms043.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "WARNING: too many xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "Notification: Stop simplevisor at vocms042.cern.ch: 70%>=70%\r\n",
      " inodes\n",
      "OK: xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "Notification: Restart simplevisor at vocms043.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "Notification: Restart simplevisor at vocms042.cern.ch: 59% < 60%\r\n",
      " inodes\n",
      "PopDB cronJob of cron_2019-04-26_04-30-03.log\n",
      "Notification: Stop two insertion agents at vocms043.cern.ch\n",
      "Notification: Stop two insertion agents at vocms042.cern.ch\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-27_04-30-04.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-28_04-30-02.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-29_04-30-01.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-04-30_04-30-06.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-05-01_04-30-02.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-05-02_04-30-01.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-05-03_04-30-02.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-05-04_04-30-01.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-05-05_04-30-04.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-05-06_04-30-04.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-05-07_04-30-04.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-05-08_04-30-03.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-05-09_04-30-02.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-05-10_04-30-06.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-05-11_04-30-02.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-05-12_04-30-04.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "PopDB cronJob of cron_2019-05-13_04-30-01.log\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "WARNING: too many xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "OK: xrootd-cms-eos-popularity messages stored on the dashb brokers\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "The collector xrootd_1 in vocms043.cern.ch was not running\n",
      "The collector xrootd_2 in vocms043.cern.ch was not running\n",
      "The collector xrootd_2 in vocms042.cern.ch was not running\n",
      "The collector xrootd_1 in vocms042.cern.ch was not running\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "The collector xrootd_2 in vocms043.cern.ch was not running\n",
      "The collector xrootd_1 in vocms042.cern.ch was not running\n",
      "The collector xrootd_2 in vocms042.cern.ch was not running\n",
      "The collector xrootd_1 in vocms043.cern.ch was not running\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "The collector xrootd_1 in vocms043.cern.ch was not running\n",
      "The collector xrootd_2 in vocms043.cern.ch was not running\n",
      "The collector xrootd_1 in vocms042.cern.ch was not running\n",
      "The collector xrootd_2 in vocms042.cern.ch was not running\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron alert CMS Popularity\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron alert CMS Popularity\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron alert CMS Popularity\n",
      "Cron alert CMS Popularity\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron alert CMS Popularity\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Cron alert CMS Popularity\n",
      "Cron alert CMS Popularity\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron alert CMS Popularity\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron alert CMS Popularity\n",
      "Cron alert CMS Popularity\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron alert CMS Popularity\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Cron <root@vocms041> cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n",
      "Problem POPDB Xrootd File2DS CRON\n"
     ]
    }
   ],
   "source": [
    "# rddAlerts[0]\n",
    "for i in rddAlerts:\n",
    "    print(i[\"subject\"])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 97,
   "metadata": {},
   "outputs": [],
   "source": [
    "pdAlerts = alerts.toPandas()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 105,
   "metadata": {},
   "outputs": [],
   "source": [
    "pdAlertsSeries = pdAlerts['value'].map(literal_eval)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 150,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas\n",
    "pdAlertsDf = pandas.DataFrame(list(pdAlertsSeries))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 148,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0                      Problem POPDB Xrootd File2DS CRON\n",
       "1                      Problem POPDB Xrootd File2DS CRON\n",
       "2                      Problem POPDB Xrootd File2DS CRON\n",
       "3      Cron <root@vocms041> cd /opt/CMSDataPopularity...\n",
       "4                      Problem POPDB Xrootd File2DS CRON\n",
       "5                      Problem POPDB Xrootd File2DS CRON\n",
       "6          PopDB cronJob of cron_2019-04-05_04-30-06.log\n",
       "7      WARNING: too many xrootd-cms-eos-popularity me...\n",
       "8      OK: xrootd-cms-eos-popularity messages stored ...\n",
       "9                      Problem POPDB Xrootd File2DS CRON\n",
       "10                     Problem POPDB Xrootd File2DS CRON\n",
       "11                     Problem POPDB Xrootd File2DS CRON\n",
       "12     Cron <root@vocms041> cd /opt/CMSDataPopularity...\n",
       "13                     Problem POPDB Xrootd File2DS CRON\n",
       "14         PopDB cronJob of cron_2019-04-06_04-30-05.log\n",
       "15                     Problem POPDB Xrootd File2DS CRON\n",
       "16                     Problem POPDB Xrootd File2DS CRON\n",
       "17     Cron <root@vocms041> cd /opt/CMSDataPopularity...\n",
       "18                     Problem POPDB Xrootd File2DS CRON\n",
       "19         PopDB cronJob of cron_2019-04-07_04-30-04.log\n",
       "20                     Problem POPDB Xrootd File2DS CRON\n",
       "21     WARNING: too many xrootd-cms-eos-popularity me...\n",
       "22     OK: xrootd-cms-eos-popularity messages stored ...\n",
       "23                     Problem POPDB Xrootd File2DS CRON\n",
       "24     Cron <root@vocms041> cd /opt/CMSDataPopularity...\n",
       "25                     Problem POPDB Xrootd File2DS CRON\n",
       "26                     Problem POPDB Xrootd File2DS CRON\n",
       "27         PopDB cronJob of cron_2019-04-08_04-30-05.log\n",
       "28                     Problem POPDB Xrootd File2DS CRON\n",
       "29                     Problem POPDB Xrootd File2DS CRON\n",
       "                             ...                        \n",
       "535                    Problem POPDB Xrootd File2DS CRON\n",
       "536                    Problem POPDB Xrootd File2DS CRON\n",
       "537                    Problem POPDB Xrootd File2DS CRON\n",
       "538    Cron <root@vocms041> cd /opt/CMSDataPopularity...\n",
       "539                    Problem POPDB Xrootd File2DS CRON\n",
       "540                    Problem POPDB Xrootd File2DS CRON\n",
       "541                    Problem POPDB Xrootd File2DS CRON\n",
       "542                    Problem POPDB Xrootd File2DS CRON\n",
       "543                    Problem POPDB Xrootd File2DS CRON\n",
       "544                    Problem POPDB Xrootd File2DS CRON\n",
       "545                    Problem POPDB Xrootd File2DS CRON\n",
       "546                    Problem POPDB Xrootd File2DS CRON\n",
       "547                    Problem POPDB Xrootd File2DS CRON\n",
       "548                    Problem POPDB Xrootd File2DS CRON\n",
       "549                    Problem POPDB Xrootd File2DS CRON\n",
       "550                    Problem POPDB Xrootd File2DS CRON\n",
       "551                    Problem POPDB Xrootd File2DS CRON\n",
       "552                    Problem POPDB Xrootd File2DS CRON\n",
       "553                    Problem POPDB Xrootd File2DS CRON\n",
       "554                    Problem POPDB Xrootd File2DS CRON\n",
       "555                    Problem POPDB Xrootd File2DS CRON\n",
       "556                    Problem POPDB Xrootd File2DS CRON\n",
       "557                    Problem POPDB Xrootd File2DS CRON\n",
       "558                    Problem POPDB Xrootd File2DS CRON\n",
       "559                    Problem POPDB Xrootd File2DS CRON\n",
       "560                    Problem POPDB Xrootd File2DS CRON\n",
       "561                    Problem POPDB Xrootd File2DS CRON\n",
       "562                    Problem POPDB Xrootd File2DS CRON\n",
       "563                    Problem POPDB Xrootd File2DS CRON\n",
       "564                    Problem POPDB Xrootd File2DS CRON\n",
       "Name: subject, Length: 565, dtype: object"
      ]
     },
     "execution_count": 148,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pdAlertsDf.head()\n",
    "pdAlertsDf['subject']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 153,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>body</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>subject</th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>CRITICAL: too many xrootd-cms-eos-popularity messages stored on the dashb brokers</th>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Cron &lt;root@vocms041&gt; cd /opt/CMSDataPopularity/xrootd; python2.6 lib/checkMViews.py</th>\n",
       "      <td>32</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Cron alert CMS Popularity</th>\n",
       "      <td>11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Notification: Restart simplevisor at vocms042.cern.ch: 59% &lt; 60%\\r\\n inodes</th>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Notification: Restart simplevisor at vocms043.cern.ch: 59% &lt; 60%\\r\\n inodes</th>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Notification: Stop simplevisor at vocms042.cern.ch: 70%&gt;=70%\\r\\n inodes</th>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Notification: Stop simplevisor at vocms043.cern.ch: 70%&gt;=70%\\r\\n inodes</th>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Notification: Stop simplevisor at vocms043.cern.ch: 71%&gt;=70%\\r\\n inodes</th>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Notification: Stop two insertion agents at vocms042.cern.ch</th>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Notification: Stop two insertion agents at vocms043.cern.ch</th>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>OK: xrootd-cms-eos-popularity messages stored on the dashb brokers</th>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopDB cronJob of cron_2019-04-05_04-30-06.log</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopDB cronJob of cron_2019-04-06_04-30-05.log</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopDB cronJob of cron_2019-04-07_04-30-04.log</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopDB cronJob of cron_2019-04-08_04-30-05.log</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopDB cronJob of cron_2019-04-09_04-30-04.log</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopDB cronJob of cron_2019-04-10_04-30-04.log</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopDB cronJob of cron_2019-04-11_04-30-04.log</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopDB cronJob of cron_2019-04-12_04-30-04.log</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopDB cronJob of cron_2019-04-13_04-30-01.log</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopDB cronJob of cron_2019-04-14_04-30-01.log</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopDB cronJob of cron_2019-04-15_04-30-05.log</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopDB cronJob of cron_2019-04-16_04-30-05.log</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopDB cronJob of cron_2019-04-17_04-30-03.log</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopDB cronJob of cron_2019-04-18_04-30-02.log</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopDB cronJob of cron_2019-04-19_04-30-04.log</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopDB cronJob of cron_2019-04-20_04-30-08.log</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopDB cronJob of cron_2019-04-21_04-30-05.log</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopDB cronJob of cron_2019-04-22_04-30-03.log</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopDB cronJob of cron_2019-04-23_04-30-03.log</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopDB cronJob of cron_2019-04-24_04-30-02.log</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopDB cronJob of cron_2019-04-25_04-30-04.log</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopDB cronJob of cron_2019-04-26_04-30-03.log</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopDB cronJob of cron_2019-04-27_04-30-04.log</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopDB cronJob of cron_2019-04-28_04-30-02.log</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopDB cronJob of cron_2019-04-29_04-30-01.log</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopDB cronJob of cron_2019-04-30_04-30-06.log</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopDB cronJob of cron_2019-05-01_04-30-02.log</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopDB cronJob of cron_2019-05-02_04-30-01.log</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopDB cronJob of cron_2019-05-03_04-30-02.log</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopDB cronJob of cron_2019-05-04_04-30-01.log</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopDB cronJob of cron_2019-05-05_04-30-04.log</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopDB cronJob of cron_2019-05-06_04-30-04.log</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopDB cronJob of cron_2019-05-07_04-30-04.log</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopDB cronJob of cron_2019-05-08_04-30-03.log</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopDB cronJob of cron_2019-05-09_04-30-02.log</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopDB cronJob of cron_2019-05-10_04-30-06.log</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopDB cronJob of cron_2019-05-11_04-30-02.log</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopDB cronJob of cron_2019-05-12_04-30-04.log</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopDB cronJob of cron_2019-05-13_04-30-01.log</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Problem POPDB Xrootd File2DS CRON</th>\n",
       "      <td>392</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>The collector xrootd_1 in vocms042.cern.ch was not running</th>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>The collector xrootd_1 in vocms043.cern.ch was not running</th>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>The collector xrootd_2 in vocms042.cern.ch was not running</th>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>The collector xrootd_2 in vocms043.cern.ch was not running</th>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>WARNING: too many xrootd-cms-eos-popularity messages stored on the dashb brokers</th>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                    body\n",
       "subject                                                 \n",
       "CRITICAL: too many xrootd-cms-eos-popularity me...     3\n",
       "Cron <root@vocms041> cd /opt/CMSDataPopularity/...    32\n",
       "Cron alert CMS Popularity                             11\n",
       "Notification: Restart simplevisor at vocms042.c...    15\n",
       "Notification: Restart simplevisor at vocms043.c...    14\n",
       "Notification: Stop simplevisor at vocms042.cern...    15\n",
       "Notification: Stop simplevisor at vocms043.cern...    12\n",
       "Notification: Stop simplevisor at vocms043.cern...     2\n",
       "Notification: Stop two insertion agents at vocm...     2\n",
       "Notification: Stop two insertion agents at vocm...     2\n",
       "OK: xrootd-cms-eos-popularity messages stored o...     5\n",
       "PopDB cronJob of cron_2019-04-05_04-30-06.log          1\n",
       "PopDB cronJob of cron_2019-04-06_04-30-05.log          1\n",
       "PopDB cronJob of cron_2019-04-07_04-30-04.log          1\n",
       "PopDB cronJob of cron_2019-04-08_04-30-05.log          1\n",
       "PopDB cronJob of cron_2019-04-09_04-30-04.log          1\n",
       "PopDB cronJob of cron_2019-04-10_04-30-04.log          1\n",
       "PopDB cronJob of cron_2019-04-11_04-30-04.log          1\n",
       "PopDB cronJob of cron_2019-04-12_04-30-04.log          1\n",
       "PopDB cronJob of cron_2019-04-13_04-30-01.log          1\n",
       "PopDB cronJob of cron_2019-04-14_04-30-01.log          1\n",
       "PopDB cronJob of cron_2019-04-15_04-30-05.log          1\n",
       "PopDB cronJob of cron_2019-04-16_04-30-05.log          1\n",
       "PopDB cronJob of cron_2019-04-17_04-30-03.log          1\n",
       "PopDB cronJob of cron_2019-04-18_04-30-02.log          1\n",
       "PopDB cronJob of cron_2019-04-19_04-30-04.log          1\n",
       "PopDB cronJob of cron_2019-04-20_04-30-08.log          1\n",
       "PopDB cronJob of cron_2019-04-21_04-30-05.log          1\n",
       "PopDB cronJob of cron_2019-04-22_04-30-03.log          1\n",
       "PopDB cronJob of cron_2019-04-23_04-30-03.log          1\n",
       "PopDB cronJob of cron_2019-04-24_04-30-02.log          1\n",
       "PopDB cronJob of cron_2019-04-25_04-30-04.log          1\n",
       "PopDB cronJob of cron_2019-04-26_04-30-03.log          1\n",
       "PopDB cronJob of cron_2019-04-27_04-30-04.log          1\n",
       "PopDB cronJob of cron_2019-04-28_04-30-02.log          1\n",
       "PopDB cronJob of cron_2019-04-29_04-30-01.log          1\n",
       "PopDB cronJob of cron_2019-04-30_04-30-06.log          1\n",
       "PopDB cronJob of cron_2019-05-01_04-30-02.log          1\n",
       "PopDB cronJob of cron_2019-05-02_04-30-01.log          1\n",
       "PopDB cronJob of cron_2019-05-03_04-30-02.log          1\n",
       "PopDB cronJob of cron_2019-05-04_04-30-01.log          1\n",
       "PopDB cronJob of cron_2019-05-05_04-30-04.log          1\n",
       "PopDB cronJob of cron_2019-05-06_04-30-04.log          1\n",
       "PopDB cronJob of cron_2019-05-07_04-30-04.log          1\n",
       "PopDB cronJob of cron_2019-05-08_04-30-03.log          1\n",
       "PopDB cronJob of cron_2019-05-09_04-30-02.log          1\n",
       "PopDB cronJob of cron_2019-05-10_04-30-06.log          1\n",
       "PopDB cronJob of cron_2019-05-11_04-30-02.log          1\n",
       "PopDB cronJob of cron_2019-05-12_04-30-04.log          1\n",
       "PopDB cronJob of cron_2019-05-13_04-30-01.log          1\n",
       "Problem POPDB Xrootd File2DS CRON                    392\n",
       "The collector xrootd_1 in vocms042.cern.ch was ...     3\n",
       "The collector xrootd_1 in vocms043.cern.ch was ...     3\n",
       "The collector xrootd_2 in vocms042.cern.ch was ...     4\n",
       "The collector xrootd_2 in vocms043.cern.ch was ...     4\n",
       "WARNING: too many xrootd-cms-eos-popularity mes...     7"
      ]
     },
     "execution_count": 153,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "agg=pdAlertsDf.groupby('subject').count()\n",
    "agg"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.5"
  },
  "sparkconnect": {
   "bundled_options": [],
   "list_of_options": [
    {
     "name": "spark.jars",
     "value": "/eos/home-y/ysunthor/SWAN_projects/test"
    },
    {
     "name": "spark.jars.packages",
     "value": "org.apache.spark:spark-sql-kafka-0-10_2.11:2.4.1"
    }
   ]
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
